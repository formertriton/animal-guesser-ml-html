<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ML Animal Guessing Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .game-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
            text-align: center;
            min-height: 500px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 2rem;
        }

        .game-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2rem;
            font-size: 0.9rem;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 0.5rem 1rem;
            border-radius: 10px;
            min-width: 120px;
        }

        .question-section {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 2rem;
            margin: 1rem 0;
            min-height: 150px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .question {
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            line-height: 1.4;
        }

        .button-group {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 0.8rem 2rem;
            font-size: 1rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            min-width: 100px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #4834d4, #686de0);
        }

        .btn-success {
            background: linear-gradient(45deg, #00d2d3, #54a0ff);
        }

        .input-section {
            margin: 1rem 0;
        }

        .text-input {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 0.8rem;
            font-size: 1rem;
            border-radius: 10px;
            width: 100%;
            margin-bottom: 1rem;
        }

        .text-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .learning-indicator {
            background: linear-gradient(45deg, #ff9f43, #feca57);
            color: #2c2c54;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: bold;
            margin: 1rem 0;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.8; }
            50% { opacity: 1; }
            100% { opacity: 0.8; }
        }

        .confidence-bar {
            background: rgba(255, 255, 255, 0.2);
            height: 20px;
            border-radius: 10px;
            margin: 1rem 0;
            overflow: hidden;
        }

        .confidence-fill {
            background: linear-gradient(45deg, #00d2d3, #54a0ff);
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .animal-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .animal-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .animal-card:hover {
            transform: scale(1.05);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ü¶Å ML Animal Guesser</h1>
        <p class="subtitle">Think of an animal, and I'll try to guess it while learning from every game!</p>
        
        <div class="game-stats">
            <div class="stat-item">
                <strong>Games Played</strong><br>
                <span id="gamesPlayed">0</span>
            </div>
            <div class="stat-item">
                <strong>Success Rate</strong><br>
                <span id="successRate">0%</span>
            </div>
            <div class="stat-item">
                <strong>Animals Known</strong><br>
                <span id="animalsKnown">12</span>
            </div>
        </div>

        <div id="gameArea" class="question-section">
            <div id="startScreen">
                <h2>Ready to Challenge the AI?</h2>
                <p>Think of any animal, and I'll try to guess it by asking yes/no questions. Every game makes me smarter!</p>
                <div class="button-group">
                    <button class="btn" onclick="startGame()">Start Game</button>
                    <button class="btn btn-secondary" onclick="showLearnedAnimals()">View Learned Animals</button>
                </div>
            </div>

            <div id="gameScreen" class="hidden">
                <div id="confidenceSection">
                    <p>AI Confidence: <span id="confidenceText">50%</span></p>
                    <div class="confidence-bar">
                        <div id="confidenceFill" class="confidence-fill" style="width: 50%"></div>
                    </div>
                </div>
                
                <div class="question" id="questionText">Think of your animal and click "Ready" when you have one in mind!</div>
                
                <div id="questionButtons" class="button-group">
                    <button class="btn btn-success" onclick="answerYes()">Yes</button>
                    <button class="btn" onclick="answerNo()">No</button>
                </div>

                <div id="readyButton" class="button-group">
                    <button class="btn" onclick="askFirstQuestion()">Ready!</button>
                </div>
            </div>

            <div id="guessScreen" class="hidden">
                <div class="question" id="guessText">Is your animal a Dog?</div>
                <div class="button-group">
                    <button class="btn btn-success" onclick="correctGuess()">Yes, Correct!</button>
                    <button class="btn" onclick="wrongGuess()">No, Wrong</button>
                </div>
            </div>

            <div id="learningScreen" class="hidden">
                <div class="learning-indicator">üß† Learning Mode Activated!</div>
                <div class="question">What animal were you thinking of?</div>
                <div class="input-section">
                    <input type="text" id="newAnimal" class="text-input" placeholder="Enter the animal name...">
                </div>
                <div class="question">Can you describe it? (This helps me learn!)</div>
                <div class="input-section">
                    <input type="text" id="animalDescription" class="text-input" placeholder="e.g., It's a large mammal that lives in water...">
                </div>
                <div class="button-group">
                    <button class="btn btn-success" onclick="learnNewAnimal()">Teach the AI</button>
                    <button class="btn btn-secondary" onclick="skipLearning()">Skip</button>
                </div>
            </div>

            <div id="resultScreen" class="hidden">
                <h2 id="resultTitle">Thanks for playing!</h2>
                <p id="resultMessage">Every game makes me smarter!</p>
                <div class="button-group">
                    <button class="btn" onclick="playAgain()">Play Again</button>
                    <button class="btn btn-secondary" onclick="showLearnedAnimals()">View Progress</button>
                </div>
            </div>

            <div id="animalsScreen" class="hidden">
                <h2>Animals I've Learned</h2>
                <div id="animalsList" class="animal-grid"></div>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="backToStart()">Back to Game</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game state and ML logic
        class AnimalGuessingML {
            constructor() {
                this.animals = this.loadAnimals();
                this.questions = this.loadQuestions();
                this.gameHistory = this.loadGameHistory();
                this.currentGame = null;
                this.stats = this.loadStats();
                this.updateDisplay();
            }

            loadAnimals() {
                const defaultAnimals = [
                    { name: "Dog", features: { "domestic": 1, "mammal": 1, "four_legs": 1, "barks": 1, "carnivore": 0.5 } },
                    { name: "Cat", features: { "domestic": 1, "mammal": 1, "four_legs": 1, "purrs": 1, "carnivore": 1 } },
                    { name: "Elephant", features: { "mammal": 1, "large": 1, "four_legs": 1, "trunk": 1, "herbivore": 1 } },
                    { name: "Lion", features: { "mammal": 1, "carnivore": 1, "four_legs": 1, "wild": 1, "roars": 1 } },
                    { name: "Fish", features: { "aquatic": 1, "fins": 1, "gills": 1, "scales": 1, "cold_blooded": 1 } },
                    { name: "Bird", features: { "flies": 1, "feathers": 1, "beak": 1, "lays_eggs": 1, "warm_blooded": 1 } },
                    { name: "Snake", features: { "reptile": 1, "no_legs": 1, "cold_blooded": 1, "carnivore": 1, "long": 1 } },
                    { name: "Rabbit", features: { "mammal": 1, "herbivore": 1, "four_legs": 1, "hops": 1, "long_ears": 1 } },
                    { name: "Bear", features: { "mammal": 1, "large": 1, "four_legs": 1, "omnivore": 1, "wild": 1 } },
                    { name: "Monkey", features: { "mammal": 1, "primate": 1, "climbs": 1, "intelligent": 1, "omnivore": 1 } },
                    { name: "Whale", features: { "mammal": 1, "aquatic": 1, "large": 1, "intelligent": 1, "warm_blooded": 1 } },
                    { name: "Shark", features: { "fish": 1, "aquatic": 1, "carnivore": 1, "predator": 1, "large": 1 } }
                ];
                return JSON.parse(localStorage.getItem('ml_animals') || JSON.stringify(defaultAnimals));
            }

            loadQuestions() {
                const defaultQuestions = [
                    { text: "Is it a mammal?", feature: "mammal", weight: 0.8 },
                    { text: "Does it live on land?", feature: "terrestrial", weight: 0.7 },
                    { text: "Is it larger than a house cat?", feature: "large", weight: 0.6 },
                    { text: "Is it a carnivore (meat-eater)?", feature: "carnivore", weight: 0.7 },
                    { text: "Does it have four legs?", feature: "four_legs", weight: 0.8 },
                    { text: "Is it a domestic animal?", feature: "domestic", weight: 0.6 },
                    { text: "Can it fly?", feature: "flies", weight: 0.9 },
                    { text: "Does it live in water?", feature: "aquatic", weight: 0.8 },
                    { text: "Is it a predator?", feature: "predator", weight: 0.6 },
                    { text: "Does it have fur?", feature: "fur", weight: 0.7 }
                ];
                return JSON.parse(localStorage.getItem('ml_questions') || JSON.stringify(defaultQuestions));
            }

            loadGameHistory() {
                return JSON.parse(localStorage.getItem('game_history') || '[]');
            }

            loadStats() {
                return JSON.parse(localStorage.getItem('game_stats') || '{"played": 0, "correct": 0}');
            }

            saveData() {
                localStorage.setItem('ml_animals', JSON.stringify(this.animals));
                localStorage.setItem('ml_questions', JSON.stringify(this.questions));
                localStorage.setItem('game_history', JSON.stringify(this.gameHistory));
                localStorage.setItem('game_stats', JSON.stringify(this.stats));
            }

            startNewGame() {
                this.currentGame = {
                    answers: {},
                    questionIndex: 0,
                    askedQuestions: [],
                    confidence: 50
                };
            }

            getNextQuestion() {
                // ML algorithm: Select questions that maximize information gain
                const availableQuestions = this.questions.filter(q => 
                    !this.currentGame.askedQuestions.includes(q.feature)
                );
                
                if (availableQuestions.length === 0) return null;

                // Calculate information gain for each question
                let bestQuestion = availableQuestions[0];
                let maxGain = 0;

                availableQuestions.forEach(question => {
                    const gain = this.calculateInformationGain(question.feature);
                    if (gain > maxGain) {
                        maxGain = gain;
                        bestQuestion = question;
                    }
                });

                return bestQuestion;
            }

            calculateInformationGain(feature) {
                // Simplified information gain calculation
                const candidates = this.getCandidateAnimals();
                if (candidates.length <= 1) return 0;

                let yesCount = 0;
                candidates.forEach(animal => {
                    if (animal.features[feature] && animal.features[feature] > 0.5) {
                        yesCount++;
                    }
                });

                const yesRatio = yesCount / candidates.length;
                const noRatio = 1 - yesRatio;

                // Calculate entropy reduction
                const entropy = -(yesRatio * Math.log2(yesRatio || 0.001) + noRatio * Math.log2(noRatio || 0.001));
                return entropy;
            }

            getCandidateAnimals() {
                // Filter animals based on current answers
                return this.animals.filter(animal => {
                    for (let feature in this.currentGame.answers) {
                        const answer = this.currentGame.answers[feature];
                        const animalValue = animal.features[feature] || 0;
                        
                        if (answer === 1 && animalValue < 0.5) return false;
                        if (answer === 0 && animalValue > 0.5) return false;
                    }
                    return true;
                });
            }

            makeGuess() {
                const candidates = this.getCandidateAnimals();
                if (candidates.length === 0) return null;

                // Score each candidate based on feature matches
                let bestAnimal = candidates[0];
                let bestScore = 0;

                candidates.forEach(animal => {
                    let score = 0;
                    let totalFeatures = 0;

                    for (let feature in this.currentGame.answers) {
                        const answer = this.currentGame.answers[feature];
                        const animalValue = animal.features[feature] || 0;
                        totalFeatures++;

                        if (answer === 1 && animalValue > 0.5) score++;
                        if (answer === 0 && animalValue < 0.5) score++;
                    }

                    const normalizedScore = totalFeatures > 0 ? score / totalFeatures : 0;
                    if (normalizedScore > bestScore) {
                        bestScore = normalizedScore;
                        bestAnimal = animal;
                    }
                });

                this.currentGame.confidence = Math.round(bestScore * 100);
                return bestAnimal;
            }

            answerQuestion(feature, answer) {
                this.currentGame.answers[feature] = answer ? 1 : 0;
                this.currentGame.askedQuestions.push(feature);
                
                // Update confidence based on remaining candidates
                const candidates = this.getCandidateAnimals();
                this.currentGame.confidence = Math.max(10, Math.min(95, 100 - candidates.length * 10));
            }

            learnFromGame(actualAnimal, description) {
                // Add new animal or update existing one
                let animal = this.animals.find(a => a.name.toLowerCase() === actualAnimal.toLowerCase());
                
                if (!animal) {
                    animal = { name: actualAnimal, features: {} };
                    this.animals.push(animal);
                }

                // Update features based on answers
                for (let feature in this.currentGame.answers) {
                    animal.features[feature] = this.currentGame.answers[feature];
                }

                // Extract features from description using simple keyword matching
                if (description) {
                    this.extractFeaturesFromDescription(animal, description);
                }

                // Record game history for further learning
                this.gameHistory.push({
                    date: new Date().toISOString(),
                    animal: actualAnimal,
                    answers: { ...this.currentGame.answers },
                    description: description,
                    success: false
                });

                this.saveData();
            }

            extractFeaturesFromDescription(animal, description) {
                const keywords = {
                    'large': ['large', 'big', 'huge', 'massive', 'giant'],
                    'small': ['small', 'tiny', 'little', 'miniature'],
                    'aquatic': ['water', 'ocean', 'sea', 'swimming', 'aquatic'],
                    'flies': ['fly', 'flying', 'wings', 'air', 'flight'],
                    'domestic': ['pet', 'domestic', 'house', 'tame'],
                    'wild': ['wild', 'jungle', 'forest', 'safari'],
                    'carnivore': ['meat', 'carnivore', 'predator', 'hunter'],
                    'herbivore': ['plants', 'grass', 'herbivore', 'vegetarian']
                };

                const desc = description.toLowerCase();
                for (let feature in keywords) {
                    for (let keyword of keywords[feature]) {
                        if (desc.includes(keyword)) {
                            animal.features[feature] = 1;
                            break;
                        }
                    }
                }
            }

            recordSuccess(wasCorrect) {
                this.stats.played++;
                if (wasCorrect) this.stats.correct++;
                this.saveData();
                this.updateDisplay();
            }

            updateDisplay() {
                document.getElementById('gamesPlayed').textContent = this.stats.played;
                document.getElementById('successRate').textContent = 
                    this.stats.played > 0 ? Math.round((this.stats.correct / this.stats.played) * 100) + '%' : '0%';
                document.getElementById('animalsKnown').textContent = this.animals.length;
            }
        }

        // Initialize ML system
        const mlSystem = new AnimalGuessingML();
        let currentQuestion = null;

        function startGame() {
            showScreen('gameScreen');
            mlSystem.startNewGame();
            document.getElementById('questionText').textContent = "Think of your animal and click 'Ready' when you have one in mind!";
            document.getElementById('readyButton').classList.remove('hidden');
            document.getElementById('questionButtons').classList.add('hidden');
            updateConfidence(50);
        }

        function askFirstQuestion() {
            document.getElementById('readyButton').classList.add('hidden');
            askNextQuestion();
        }

        function askNextQuestion() {
            currentQuestion = mlSystem.getNextQuestion();
            
            if (!currentQuestion || mlSystem.currentGame.askedQuestions.length >= 8) {
                makeGuess();
                return;
            }

            document.getElementById('questionText').textContent = currentQuestion.text;
            document.getElementById('questionButtons').classList.remove('hidden');
            updateConfidence(mlSystem.currentGame.confidence);
        }

        function answerYes() {
            mlSystem.answerQuestion(currentQuestion.feature, true);
            askNextQuestion();
        }

        function answerNo() {
            mlSystem.answerQuestion(currentQuestion.feature, false);
            askNextQuestion();
        }

        function makeGuess() {
            const guess = mlSystem.makeGuess();
            if (guess) {
                showScreen('guessScreen');
                document.getElementById('guessText').textContent = `Is your animal a ${guess.name}?`;
                updateConfidence(mlSystem.currentGame.confidence);
            } else {
                // No good guess available, go to learning mode
                showScreen('learningScreen');
            }
        }

        function correctGuess() {
            mlSystem.recordSuccess(true);
            showScreen('resultScreen');
            document.getElementById('resultTitle').textContent = 'üéâ I guessed it!';
            document.getElementById('resultMessage').textContent = 'Thanks for playing! I\'m getting better with each game.';
        }

        function wrongGuess() {
            mlSystem.recordSuccess(false);
            showScreen('learningScreen');
        }

        function learnNewAnimal() {
            const animalName = document.getElementById('newAnimal').value.trim();
            const description = document.getElementById('animalDescription').value.trim();
            
            if (!animalName) {
                alert('Please enter the animal name!');
                return;
            }

            mlSystem.learnFromGame(animalName, description);
            showScreen('resultScreen');
            document.getElementById('resultTitle').textContent = 'üß† Thank you for teaching me!';
            document.getElementById('resultMessage').textContent = `I've learned about ${animalName}! This will help me guess better next time.`;
            
            // Clear inputs
            document.getElementById('newAnimal').value = '';
            document.getElementById('animalDescription').value = '';
        }

        function skipLearning() {
            showScreen('resultScreen');
            document.getElementById('resultTitle').textContent = 'Thanks for playing!';
            document.getElementById('resultMessage').textContent = 'Every game helps me improve, even if I don\'t guess correctly!';
        }

        function playAgain() {
            showScreen('startScreen');
        }

        function showLearnedAnimals() {
            showScreen('animalsScreen');
            const animalsList = document.getElementById('animalsList');
            animalsList.innerHTML = '';
            
            mlSystem.animals.forEach(animal => {
                const animalCard = document.createElement('div');
                animalCard.className = 'animal-card';
                animalCard.innerHTML = `
                    <h3>${animal.name}</h3>
                    <small>${Object.keys(animal.features).length} features learned</small>
                `;
                animalsList.appendChild(animalCard);
            });
        }

        function backToStart() {
            showScreen('startScreen');
        }

        function showScreen(screenId) {
            const screens = ['startScreen', 'gameScreen', 'guessScreen', 'learningScreen', 'resultScreen', 'animalsScreen'];
            screens.forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
        }

        function updateConfidence(confidence) {
            document.getElementById('confidenceText').textContent = confidence + '%';
            document.getElementById('confidenceFill').style.width = confidence + '%';
        }
    </script>
</body>
</html>